<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AudioInsight: Consumer Intelligence from Reddit Audio Product Discussions – DSAN 6000 Big Data Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DSAN 6000 Big Data Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./eda.html"> 
<span class="menu-text">EDA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./nlp.html"> 
<span class="menu-text">NLP</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./ml.html"> 
<span class="menu-text">ML</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./conclusion.html"> 
<span class="menu-text">Conclusion</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#team-members" id="toc-team-members" class="nav-link active" data-scroll-target="#team-members">Team Members</a></li>
  <li><a href="#project-overview" id="toc-project-overview" class="nav-link" data-scroll-target="#project-overview">Project Overview</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a></li>
  <li><a href="#business-questions" id="toc-business-questions" class="nav-link" data-scroll-target="#business-questions">Business Questions</a></li>
  </ul></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a>
  <ul class="collapse">
  <li><a href="#data-processing-infrastructure" id="toc-data-processing-infrastructure" class="nav-link" data-scroll-target="#data-processing-infrastructure">Data Processing Infrastructure</a></li>
  <li><a href="#analysis-pipeline" id="toc-analysis-pipeline" class="nav-link" data-scroll-target="#analysis-pipeline">Analysis Pipeline</a></li>
  </ul></li>
  <li><a href="#key-findings-preview" id="toc-key-findings-preview" class="nav-link" data-scroll-target="#key-findings-preview">Key Findings Preview</a>
  <ul class="collapse">
  <li><a href="#major-insights" id="toc-major-insights" class="nav-link" data-scroll-target="#major-insights">Major Insights</a></li>
  <li><a href="#business-impact" id="toc-business-impact" class="nav-link" data-scroll-target="#business-impact">Business Impact</a></li>
  </ul></li>
  <li><a href="#navigation" id="toc-navigation" class="nav-link" data-scroll-target="#navigation">Navigation</a></li>
  <li><a href="#repository" id="toc-repository" class="nav-link" data-scroll-target="#repository">Repository</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AudioInsight: Consumer Intelligence from Reddit Audio Product Discussions</h1>
<p class="subtitle lead">DSAN 6000 Big Data Analytics - Fall 2025</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="team-members" class="level2">
<h2 class="anchored" data-anchor-id="team-members">Team Members</h2>
<ul>
<li>Tongrui Zhang</li>
<li>Zoo Un Park</li>
<li>Ping Hill</li>
<li>Josh Lin</li>
</ul>
</section>
<section id="project-overview" class="level2">
<h2 class="anchored" data-anchor-id="project-overview">Project Overview</h2>
<p><strong>High-Level Problem Statement:</strong></p>
<p>The wireless audio market exceeds $50 billion annually, yet brands struggle to understand real-time consumer preferences and product pain points. This project analyzes <strong>9.5 million Reddit discussions</strong> across 23 audio-focused communities to extract actionable business intelligence through big data analytics, NLP, and machine learning. By examining authentic consumer conversations about wireless earbuds, headphones, and audio equipment, we identify purchase drivers, detect emerging issues, understand competitive dynamics, and predict market trends—enabling data-driven decisions for product development and marketing strategy.</p>
<section id="dataset" class="level3">
<h3 class="anchored" data-anchor-id="dataset">Dataset</h3>
<ul>
<li><strong>Source:</strong> Reddit Comments and Submissions</li>
<li><strong>Time Period:</strong> June 1, 2023 - July 31, 2024 (14 months)</li>
<li><strong>Subreddits:</strong> 23 audio-focused communities</li>
<li><strong>Scale:</strong> 9,525,830 total rows
<ul>
<li>Comments: 9,017,846</li>
<li>Submissions: 507,984</li>
</ul></li>
<li><strong>Size:</strong> ~4.5 GB (Parquet compressed)</li>
<li><strong>Storage:</strong> AWS S3 distributed processing</li>
<li><strong>Infrastructure:</strong> 4-node Spark cluster</li>
</ul>
</section>
<section id="business-questions" class="level3">
<h3 class="anchored" data-anchor-id="business-questions">Business Questions</h3>
<p>We address 11 business questions spanning three analytical approaches:</p>
<p><strong>Exploratory Data Analysis (EDA):</strong></p>
<ol type="1">
<li><strong>How does public discussion about audio products evolve over time across subreddits, days, and hours?</strong></li>
<li><strong>Which product and brand communities attract the highest engagement and user overlap on Reddit?</strong></li>
<li><strong>How do post timing and structural characteristics (title length, content type) relate to discussion depth and engagement?</strong></li>
</ol>
<p><strong>Natural Language Processing (NLP):</strong></p>
<ol start="4" type="1">
<li><strong>What features (pain points &amp; brands) and sentiments are most discussed about wireless earbuds on Reddit?</strong></li>
<li><strong>Which earbud brands dominate controversial discussion, and how does sentiment (positive/negative/neutral) differ across brands?</strong></li>
<li><strong>What emotional reactions (joy, anger, sadness, trust, etc.) do Reddit users express toward different earbud features?</strong></li>
<li><strong>How did public sentiment and discussion volume respond to the AirPods Pro USB-C launch and the transition from Lightning to USB-C?</strong></li>
</ol>
<p><strong>Machine Learning (ML):</strong></p>
<ol start="8" type="1">
<li><strong>How well can we predict Reddit post engagement (log(1+score)) using only content at posting time, and how much additional predictive power comes from early comment activity?</strong></li>
<li><strong>Can we automatically classify the emotional tone of Reddit posts (positive, negative, neutral) at scale using supervised learning?</strong></li>
<li><strong>Can we identify inauthentic promotional accounts versus genuine users in audio product discussions?</strong></li>
<li><strong>What underlying pain-point clusters exist in wireless earbud discussions, and how do these clusters differ across subreddits and communities?</strong></li>
</ol>
<p>See <a href="https://github.com/your-repo/BUSINESS_QUESTIONS.md">BUSINESS_QUESTIONS.md</a> for detailed technical approaches.</p>
</section>
</section>
<section id="methodology" class="level2">
<h2 class="anchored" data-anchor-id="methodology">Methodology</h2>
<section id="data-processing-infrastructure" class="level3">
<h3 class="anchored" data-anchor-id="data-processing-infrastructure">Data Processing Infrastructure</h3>
<ul>
<li><strong>Platform:</strong> Apache Spark cluster on AWS EC2</li>
<li><strong>Processing:</strong> Distributed computing with PySpark</li>
<li><strong>Storage:</strong> Amazon S3 for data lake architecture</li>
<li><strong>Scale:</strong> Processing hundreds of millions of rows</li>
</ul>
</section>
<section id="analysis-pipeline" class="level3">
<h3 class="anchored" data-anchor-id="analysis-pipeline">Analysis Pipeline</h3>
<ol type="1">
<li><strong>Data Acquisition &amp; Filtering</strong> (Milestone 0)
<ul>
<li>Copy full Reddit dataset from source bucket</li>
<li>Filter to subreddits of interest</li>
<li>Generate dataset statistics</li>
</ul></li>
<li><strong>Exploratory Data Analysis</strong> (Milestone 1) → <a href="./eda.html">EDA Page</a>
<ul>
<li>Statistical analysis</li>
<li>Temporal patterns</li>
<li>Community comparisons</li>
</ul></li>
<li><strong>Natural Language Processing</strong> (Milestone 2) → <a href="./nlp.html">NLP Page</a>
<ul>
<li>Sentiment analysis</li>
<li>Topic modeling</li>
<li>Text mining</li>
</ul></li>
<li><strong>Machine Learning</strong> (Milestone 3) → <a href="./ml.html">ML Page</a>
<ul>
<li>Feature engineering</li>
<li>Model training and evaluation</li>
<li>Prediction and classification</li>
</ul></li>
<li><strong>Final Analysis</strong> (Milestone 4) → <a href="./conclusion.html">Conclusion</a>
<ul>
<li>Synthesis of findings</li>
<li>Business recommendations</li>
</ul></li>
</ol>
</section>
</section>
<section id="key-findings-preview" class="level2">
<h2 class="anchored" data-anchor-id="key-findings-preview">Key Findings Preview</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Key Takeaways at a Glance
</div>
</div>
<div class="callout-body-container callout-body">
<p>Our analysis shows that:</p>
<ul>
<li><strong>Engagement is highly concentrated</strong> in a few core communities (<code>headphones</code>, <code>audiophile</code>), with clear peak posting windows during U.S. daytime and mid-week.<br>
</li>
<li>Users are <strong>most satisfied with sound quality, comfort, and ANC</strong>, but show <strong>strong negative emotions around durability, battery life, and connectivity</strong>.<br>
</li>
<li><strong>Early comment activity is the single strongest predictor of final engagement</strong>, far outweighing content-only features and confirming a strong social snowball effect in Reddit’s ranking dynamics.</li>
</ul>
</div>
</div>
<section id="major-insights" class="level3">
<h3 class="anchored" data-anchor-id="major-insights">Major Insights</h3>
<ol type="1">
<li><p><strong>EDA – Centralized Ecosystem &amp; Temporal Rhythms:</strong><br>
A small number of general audio communities drive nearly 70% of all activity, with engagement peaking during U.S. mornings and mid-week. Timing and community choice matter more than title length or post format.</p></li>
<li><p><strong>NLP – Performance vs.&nbsp;Reliability Trade-offs:</strong><br>
Redditors consistently praise <strong>sound, comfort, and ANC</strong>, but express concentrated frustration about <strong>durability, battery degradation, app bugs, and connectivity issues</strong>. Emotion analysis reveals where users feel delight vs.&nbsp;disappointment.</p></li>
<li><p><strong>ML – Early Social Proof Drives Virality:</strong><br>
Content-only models explain little of engagement variance (R² ≈ 0.12), while adding early comment features boosts R² to ~0.48. Just five early-comment features provide more predictive power than 5,000+ text features.</p></li>
</ol>
</section>
<section id="business-impact" class="level3">
<h3 class="anchored" data-anchor-id="business-impact">Business Impact</h3>
<p>These findings translate unstructured Reddit discussions into <strong>actionable consumer intelligence</strong>. Brands can:</p>
<ul>
<li><strong>Refine product roadmaps</strong> by investing in durability, battery, and connectivity improvements while preserving strengths in sound and comfort.<br>
</li>
<li><strong>Target the most impactful communities and posting windows</strong> to maximize organic reach and feedback.<br>
</li>
<li><strong>Design launch and engagement strategies</strong> that explicitly optimize the first hour of discussion, leveraging early social proof to drive long-term visibility and influence purchase decisions.</li>
</ul>
</section>
</section>
<section id="navigation" class="level2">
<h2 class="anchored" data-anchor-id="navigation">Navigation</h2>
<p>Use the navigation bar above to explore:</p>
<ul>
<li><strong><a href="./eda.html">EDA</a></strong>: Exploratory data analysis with statistical insights and temporal patterns</li>
<li><strong><a href="./nlp.html">NLP</a></strong>: Natural language processing analysis including sentiment and topics</li>
<li><strong><a href="./ml.html">ML</a></strong>: Machine learning models and predictions</li>
<li><strong><a href="./conclusion.html">Conclusion</a></strong>: Summary of findings and recommendations</li>
</ul>
</section>
<section id="repository" class="level2">
<h2 class="anchored" data-anchor-id="repository">Repository</h2>
<ul>
<li><strong>GitHub:</strong> https://github.com/gu-dsan6000/fall-2025-project-team23</li>
<li><strong>Documentation:</strong> All code, data outputs, and analysis documentation available in repository</li>
</ul>
<hr>
<p><em>Last updated: “2025-12-6”</em></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>DSAN 6000 Big Data Analytics Project</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>